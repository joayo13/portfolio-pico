---
import { getCollection } from "astro:content";
import ArrowLink from "./ArrowLink.astro";
import { SITE } from "@consts";

let posts = await getCollection("posts");
posts
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, SITE.NUM_POSTS_ON_HOMEPAGE);
---

<section>
    <h2 class="animate">RECENT POSTS</h2>
    <ul>
        {
            posts.map((post) => (
                <li class="animate">
                    <a class="group" href={`/posts/${post.id}`}>
                        <article>
                            <h3>{post.data.title}</h3>
                            <p>{post.data.description}</p>
                        </article>
                        <ArrowLink />
                    </a>
                </li>
            ))
        }
    </ul>
    <a class="see-all-link animate" href="/posts">see all posts</a>
</section>

<style>
    .group {
        text-decoration: none;
        display: block;
        padding: 1em 0;
    }

    ul {
        list-style: none;
        padding: 0;
    }
    h2 {
        margin-bottom: 0.5em;
    }

    h3,
    p {
        max-width: 20rem;
        text-wrap: nowrap;
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
        margin: 0;
    }

    li {
        border-top: 1px solid var(--white);
    }

    li:last-child {
        border-bottom: 1px solid var(--white);
    }

    h3 {
        text-transform: uppercase;
        font-weight: 700;
        letter-spacing:;
    }
</style>
